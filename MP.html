<!DOCTYPE html>
<html>
    <link rel="stylesheet" href="style1.css"/>
    <head>
        <title>Module Project</title>
    </head>
    <body>
        <nav>
            <li><a href="home.html">Home</a></li>
            <li><a href="FS.html">Fablab Safety</a></li>
            <li><a href="WD.html">Web Development</a></li>
            <li><a href="CAD.html">Computer Aided Design</a></li>
            <li><a href="CCC.html">Computer Controlled Cutting</a></li>
            <li><a href="3D.html">3D Printing</a></li>
            <li><a href="EP.html">Embedded Programming</a></li>
            <li><a href="MP.html">Module Project</a></li>
        </nav>
        <div class="Header">
            <h1>Module Project: SAVEnding</h1>
            
            <iframe width="840" height="472.5" src="https://www.youtube.com/embed/hrscSI77lYY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            <br>(Please view this video at 1080p resolution.)
            <p><img src="presentation.png" width="100%"></p>
        </div>
        <div class="Content">
            <h2>Background</h2>
            <p>Since young I have always wanted to build a machine that “eats up” money and “spits out” candies or biscuits. Something like a vending machine, but without electricity. I thought of making the whole thing entirely out of recyclables such as cardboard and skewers, however it is not as easy as it seems. Due to the lack of resources (strong glue, nails, workspace) and time, I could not build one. Now that I have the opportunity to craft something as the Final Project in DFAB, I am going to work on it, adding on with the application of Arduino.</p>
            
            <h2>Project Idea</h2>
            <p><i><b>Name:</b> SAVEnding</i> (Pronounce as SAVE-vending)</p>
            <p><i><b>Object:</b> A vending machine with embedded programming using Arduino</i></p>
            <p><i><b>Function:</b> Dispense items upon inserting coin and pushing one button</i></p>
            <p><i><b>Purpose:</b> To encourage a habit of saving since young, especially if the person tends to overspend</i></p>
            <p>My project will be named SAVEnding because it serves as a vending machine miniature and a coin saving box. My plan is whenever I insert a coin, I can press a button that links to a choice of item that I want, then seeing the item drop. The items which are placed in the dispensing columns must be useful and should ideally be free or cheaper than the value of the money deposited, so that I am more willing to save every time. I want to design a small, simple and portable machine that can function 24/7.</p>
            <p>Below shows a sketch of how SAVEnding should work (drawing done using Google Drawing):</p>
            <img src="image/Project/idea_sketch.png" width="100%">
            
            <h2>Design Inspiration</h2>
            <p>After searching up for “vending machines using Arduino”, I have come across one that fits my idea. I downloaded the 3D sketch from the website for reference. That design looks complicated at first, but after removing the rail system (which takes up a large part of the building process), it looks much easier to recreate. Picture on the left shows the original project, picture on the right shows my modified version after hiding the rail system parts. </p>
            <p><a href="image/Project/HTM.jpg" width="54%"><img src="image/Project/HTM.jpg" width="53%"></a>
            <a href="image/Project/simplified_design.png"><img src="image/Project/simplified_design.png" width="45%"></a>
            <i>(Source: <a href="https://howtomechatronics.com/projects/diy-vending-machine-arduino-based-mechatronics-project/">https://howtomechatronics.com/projects/diy-vending-machine-arduino-based-mechatronics-project/</a></i>)
            </p>
            
            <h2>Bill of Materials</h2>
            <table width="90%" border="black">
                <tr>
                    <th>Item</th>
                    <th>Quantity</th>
                    <th>Source</th>
                </tr>
                <tr>
                    <td>Arduino  Board</td>
                    <td>1</td>
                    <td>Found in kit</td>
                </tr>
                <tr>
                    <td>LCD I2C</td>
                    <td>1</td>
                    <td>Found in kit</td>
                </tr>
                <tr>
                    <td>Breadboard</td>
                    <td>1</td>
                    <td>Found in kit</td>
                </tr>
                <tr>
                    <td>PCB mounted Push Buttons</td>
                    <td>4</td>
                    <td>2 in kit, Got 2 from Mr Chew</td>
                </tr>
                <tr>
                    <td>IR Obstacle Avoidance Sensor</td>
                    <td>1</td>
                    <td>Got from Mr Chew</td>
                </tr>
                <tr>
                    <td>Continuous Rotation Servo Motor</td>
                    <td>2</td>
                    <td>Got from Mr Dorville</td>
                </tr>
                <tr>
                    <td>Thick metal wire</td>
                    <td>Sufficient</td>
                    <td>$1.50, bought from hardware shop</td>
                </tr>
                <tr>
                    <td>Plywood</td>
                    <td>2 pieces of size A1</td>
                    <td>FABLAB</td>
                </tr>
                <tr>
                    <td>Dupont wires</td>
                    <td>Sufficient: Male-to-male, Male-to-female</td>
                    <td>Some from kit and some from Mr Louis</td>
                </tr>
                
            </table>
            
            <h2>Stage I: Computer Aided Design</h2>
            <h3>Step-by-step process</h3>
            <p>File: <a href="image/Project/SAVEnding_CAD.f3d">SAVEnding_Design.f3d</a></p>
            <iframe src="MP_Structure.pdf" width="100%" height="500px"></iframe>
            <iframe width="720" height="405" src="https://www.youtube.com/embed/T_FinuGQnGA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            <iframe src="https://ichat835.autodesk360.com/shares/public/SH56a43QTfd62c1cd968032a6a39c300f982?mode=embed" width="800" height="600" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true"  frameborder="0"></iframe>
            
            <h3>Troubleshooting</h3>
            <p>I set my ‘thickness’ parameter to be 5mm and after I was advised to use 4mm plywood, I changed the thickness to 4mm. But many problems arouse, such as missing parts, cutting problems, incomplete cuts. (see image below) </p>
            <p><img src="image/Project/problem.png" width="100%"></p>
            <p>To solve these issues, I did the following: </p>
                <ol>
                    <li>I realised my ‘finger height’ parameter is still at 5mm, so I set it to ‘Thickness’. 2 problems remained, and they were resulted from the 2 pieces inside the box.</li>
                    <li>I dragged the history marker to and fro about the point of time where the mistake could have happened, and found that the length of the pieces is still “Base-10” while the finger height changed. When I edited the length to “Base-12”, somehow the cutting of the left and right walls is misaligned, so I just extended the finger instead of increasing the length of piece.</li>
                    <li>There was another problem that caused the front wall to be partially cut. It is after I clicked to edit a sketch at the front that I realised the wall thickness was set of ‘5mm’ instead of ‘Thickness’. </li>
                </ol>
            <p>So after making some adjustments, the problem is finally solved and I am able to cut 4mm plywood!</p>
            <p><i>---UPDATE: there is only 3mm or 5mm plywood to choose from :( so I wasted half a day on making changes to the design and re-aligning my DXF files.---</i></p>
            
            <h2>Stage II: LASER CUT</h2>
            <h3>Saving sketches as DXF files</h3>
            <p>The design done in Fusion 360 will be sent for laser cutting on 4mm plywood. Because at the start I did not draw each piece within 1 sketch, I will have to create new sketches to save them as DXF files. First, I click on the front face, then create sketch, and pressed ‘P’ to project. The projected sketch is exactly what I would use for vector cutting. I renamed the sketch to ‘front’. I repeated these steps for all unique pieces. Next, I right-clicked on the sketch, and select ‘Save as DXF’. Now my DXF files are ready for vector cutting.</p>
            <p><a href="image/Project/DXF.png"><img src="image/Project/DXF.png" width="100%"></a></p>
            
            <h3>Aligning &amp; Troubleshooting</h3>
            <p>But wait. Before I cut, I must first align the pieces to reduce wood wastage. A huge mistake lies in the dimensions of my pieces. Even if I use A1 plywood, the maximum number of large pieces I can fit is only 2. If I were to print all 6 sides of SAVEnding together with the remaining smaller pieces, it will leave a lot of unused wood. So I had to scale down on one parameter, which is the width. When I reduce it from 30 to 28cm, there are no errors (yay!), the only problem is the space for the servo motors at the back. It’s ok, I shortened a supporting plate and the divider too and problem resolved!</p>
            <p>But when I stepped into Fablab, Mr Chan told me that the thickness of the plywood is only 3mm and 5mm. Furthermore, the work area is 800mm &times; 600mm, so I just sat in Fablab for hours just to change some parameters and redesigning some plates. Redesigning because I spotted the mistake I made while designing the divider (see above). The final layout is shown below.</p>
            <p><img src="image/Project/Layout-1.svg" width="55%" style="background: white"> <img src="image/Project/Layout-2.svg" width="44%" style="background: white"></p>
            <h3>It's Cut o'clock!</h3>
            <p>I saved these as DXF and send it to CorelDraw to laser cut. First, I made sure the line weight is Hairline and the colour is RGB (255, 0, 0). Then I go over to preferences and adjust the settings. However, the cutting took a few times to cut through, as I increased the power and decrease the speed (might be due to dirty lens). Here's a video of the cutting process:</p>
            <iframe width="720" height="405" src="https://www.youtube.com/embed/DongGk4gjTA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            <h2>Stage III: 3D Print</h2>
            <p>Initially I wanted to mount the 4 push button switches onto stripboard, then design and 3D print 4 buttons that sit loosely on the holes cut on the front piece. However, I figured it may be difficult to assemble as I need to find a way to secure/mount the stripboard onto the back of the front piece, along the process the buttons may keep falling out. After discussing with Mr Chew, I decided to print a holder that allows the switches to sit in perfectly, and the convenience of keeping them in place for soldering.</p>
            <p>I designed a flat surface that serves as a bed for all the small holders. Each holder is made up of a cylinder of &#8960;10mm &times; 5mm (that’s the thickness of plywood it has to pass through), a negatively extruded cuboid of 6mm &times; 6mm &times; 4mm (those are the dimensions of the switches), and 2 little holes for the wires.</p>
            <p><img src="image/Project/holder_design.png" width="100%"></p>
            <p>However, I forgot to consider about the tolerance and went ahead to print. The switches cannot fit at all so this print had gone to waste. Mr Yeo tried to help by melting the holder and forcing the switch to fit (picture on the right), but I remembered that the deformed cylinder might mean not being able to fit the plywood. Hence, I had to test print different lengths of the square, i.e. 6.10mm, 6.15mm, 6.20mm, followed by another test of 6.30mm, 6.40mm. Instead of the whole thing, I printed out just 1 mini holder. The switch can finally fit perfectly in for 6.4mm. </p>
            <p><a href="image/Project/3D_holder.jpg"><img src="image/Project/3D_holder.jpg" width="45%"></a> <a href="image/Project/failed_holder.jpg"><img src="image/Project/failed_holder.jpg" width="54%"></a></p>
            <h2>Stage IV: Embedded Programming</h2>
            <h3>Circuit Planning</h3>
            <p>With reference to the circuit schematic from <a href="https://howtomechatronics.com/projects/diy-vending-machine-arduino-based-mechatronics-project/">How To Mechatronics</a>, I removed all the components related to the rail system and took away 2 continuous servo motors to save some assembling time. Before I designed my own schematic diagram using Tinkercad I did a sketch to have an idea of how many connections do I need (credits to Mr Chew for helping me out). Tinkercad does not have LCD I2C, so I will treat the last 2 connection points as SDA and SCL of I2C.</p>
            <p><img src="image/Project/circuit_sketch.jpg" width="80%"> <img src="image/Project/schematic.png" width="100%" style="background: white"></p>
            <h3>Writing the Program</h3>
            <p>I copied the code from How To Mechatronics and removed all the codes related to the rail system. That saves me about a hundred lines. Since I am using an LCD I2C, which uses almost the same code as LCD, I downloaded the library from <a href="https://www.arduinolibraries.info/libraries/liquid-crystal-i2-c">here</a> and replaced it with the original LCD library. After I am completed with the final assembly, I made some changes to the code for servo motors [<code>write()</code>] and redefine the pins connected to each component [<code>#define</code>].</p>
            <iframe src=https://create.arduino.cc/editor/chwnzyl/12bf85de-5531-454a-ba6c-98911515cc04/preview?embed style="height:630px;width:100%;margin:10px 0" frameborder=0></iframe>
            <h3>Testing the Circuit</h3>
            <p>I connected all my components onto my Arduino Board and tested the circuit. There were many mistakes made. I managed to resolve these issues after a good 3 hours of troubleshooting, with the help from Khairin, Mr Dorville and Mr Louis. </p>
            <p><b>What happened?</b> When I uploaded my sketch, the LCD was blinking rapidly at “Insert a coin!”.  Then I added in the <code>breaks</code> to each <code>switch (var) {case}</code> and uploaded again. However, nothing happened when I clicked on all 4 buttons. Mr Louis pointed out that the VCC and GND of the servo motors are connected to the wrong side of the breadboard. When I finally wired everything correctly, one of the servo motors did not work. I did not conduct checks to ensure all components are functional, thus I had to find a code to test the servo motors.</p>
            <p><img src="image/Project/circuit_mistakes.jpg" width="100%"></p>
            <p>First, I picked the sample sketch from Arduino IDE to perform a simple sweep for one of the servo motors. I define the digital pin that is connected to it, then upload the code. That motor spun, so it is functional, and the wires do not have problem. I unplugged the motor from the dupont wires (connected to breadboard) replaced it with the other motor. It did not spin, so I took it out and adjusted the wires, but it still did not work. That was how I determined that motor is <b>faulty</b>.</p>
            <p>I got a new servo motor, a functional one, and tried the circuit again. It works! I forgot to film a video of how the circuit works, but here are some pictures of the process. (Click to zoom in)</p>
            <p><a href="image/Project/testing_circuit.jpg"><img src="image/Project/testing_circuit.jpg" width="59%"></a> <a href="image/Project/dry-run.jpg"><img src="image/Project/dry-run.jpg" width="40%"></a></p>
            <h2>Stage V: First Assembly</h2>
            <p>I tried putting all the pieces together but just as I reached the last piece (front), it could not fit! Turns out that the orientation of the internal plates is upside-down, causing the rest to fit in the wrong orientation as well. And because back when I designed the structure, I did not follow what was taught, all the pieces are asymmetrical. Therefore, I had to refer to Fusion 360 to match the orientation.</p>
            <iframe width="720" height="405" src="https://www.youtube.com/embed/GYST2ATt-AY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            <h2>Stage VI: Miscellaneous – More laser cutting</h2>
            <h3>Engraving</h3>
            <p>The top of the structure looks bare, so I thought “why not give it a nice touch?” I took the DXF file of top piece, launched CorelDraw in T1442, and placed the word “SAVEnding” in the centre. I set the the text to RGB Green and selected the text for raster engraving. The result is awesome!</p>
            <p><img src="image/Project/engraving.jpg" width="60%"></p>
            <h3>Coin Guide</h3>
            <p>1 problem that surfaced while using the IR Obstacle Avoidance Sensor is: The coin will go undetected because the free fall of that metal object is too fast to be detected. I drew up a sketch of a <b>coin guide</b>, then used Fusion 360 to design the 3D structure. As this coin guide is quite tall/long (about 16cm), it will take too long to 3D print, hence I did laser cutting on upcycled acrylic pieces. </p>
            <p></p>
            <p><a href="image/Project/coin-guide_sketch.jpg"><img src="image/Project/coin-guide_sketch.jpg" width="100%"></a> <a href="image/Project/coin-guide_CAD.png"><img src="image/Project/coin-guide_CAD.png" width="100%"></a></p>
            <p>I set the settings wrongly and the acrylic (red) was not cut through after 2 times. I tried to break along the lines but spoiled it instead. Then I took another acrylic (transparent) and cut again with the correct settings. The problem lies in taking the acrylic of wrong thickness, which caused the coin to get stuck. The red acrylic is 2.5mm but I needed 3mm. Separating 2 pieces of acrylic held together by chloroform may destroy them, plus the laser cutter was in use, so I took a thin acrylic scrap (white) and stacked on top of the red acrylic and secured all the pieces together using chloroform.</p>
            <a href="image/Project/coin-guide_3D.f3d">Coin_Guide.f3d</a> <br>
            <img src="image/Project/coin-guide.jpg" width="50%"> <iframe src="https://ichat835.autodesk360.com/shares/public/SH56a43QTfd62c1cd968c0a27560f0f4765d?mode=embed" width="49%" height="600" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true"  frameborder="0"></iframe>
            <h2>Stage VII: Final assembly</h2>
            <p>Due to time constraint and the lack of experience, I asked Mr Louis to help me with the soldering of the wires connecting to the push button switches. I hot-glued some pieces together and brought SAVEnding home to assemble the motors, sensor and the wires. Before I begin the assembly, I drew out the layout design of how the wiring connnections should look like. </p>
            <p><a href="image/Project/final-layout.jpg"><img src="image/Project/final-layout.jpg" width="100%"></a></p>
            <p><a href="image/Project/solder.jpg"><img src="image/Project/solder.jpg" width="28%"></a> <a href="image/Project/coiling.jpg"><img src="image/Project/coiling.jpg" width="35%"></a> <a href="image/Project/coil_attach.jpg"><img src="image/Project/coil_attach.jpg" width="35%"></a></p>
            <ol>
                <li>I used dupont wires to extend the connections from all the components to the breadboard and Arduino.</li>
                <li>I secured the servo motors onto the holder using the given screws and my mini screwdriver.</li>
                <li>I made 2 helical coils using the thick wire bought from a nearby hardware shop and a kitchen towel roll. However, I did not have hot glue or strong tape to attach the coil to the wing of servo motor, so I made do temporarily with threads and tape. </li>
                <li>I secured the LCD using an electrical tape and fitted in my 3D-printed button holder onto the back of the front piece.</li> 
                <li>Positioning the IR Obstacle Avoidance Sensor is challenging as I ponder whether to secure it on an elevated platform on the base or front piece. Taking the distance and the limited resources I have into consideration, I stuck some leftover acrylic scraps and the failed 3D print (button holder) onto the back of the front piece.
                <li>Plugged back in the wires that I took out the previous day to finish connecting all components to the Arduino Board.</li>
                <li>Connected the Arduino to my laptop and tested out. Dropped a coin down the coin guide and adjusted the potentiometer behind the sensor accordingly.</li> 
                <li>Then the problem came; there is no response when I clicked on the buttons. Tested the servo motors using the example sketch and they are working. Could not figure out what was wrong, so I had to bring it to school to finish the assembly. Turns out the dupont wires are loose and are not totally secured in the Breadboard. (Main culprit is not keeping the wires neat.) </li>
                <li>Glued the rest of the pieces together except the front one. Also secured the Arduino Board and the sensor using hot glue. </li>
                <li>I rewrote the code for servo motor to change the speed/duration and uploaded again. All set and ready to present!</li>
            </ol>
            <p>(ensure the resolution is 1080p.)</p>
            <iframe width="720" height="405" src="https://www.youtube.com/embed/G8VsIg9mqOU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            
            <h2>Stage VIII: Presentation</h2>
            <p>I finished assembling every part and made the last changes to the code on my presentation day. It's time to test it out! At the start, everything is working well, however after my friends used it multiple times, I noticed the LCD will turn off for a brief moment when the servo motor is rotating. Could it be the current or voltage passing through the LCD is reduced?</p>
            <iframe width="720" height="405" src="https://www.youtube.com/embed/rQnbKZAD7mQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            
            <div class="extra">
                <p><b><u>Possible Developments in the Future</u></b></p>
                <p>These are some improvements I can make to SAVEnding. Due to shortage of time, I am only able to create a functional machine that detects coins and dispense items.</p>
                <ul>
                    <li>Changing the angle of the coin guide (middle layer) by about 5&deg; – so that it will roll off on its own without tilting the structure</li>
                    <li>Extend the length of wires by soldering instead of using dupont wires and replacing the breadboard with a stripboard. I also need to secure the wires along the walls of the structure, to keep them neat and presentable.</li>
                    <li>Installing a window panel and push cover at the front</li>
                    <li>Placing a coin box, possibly enclosed with a lock, at the end of coin guide to store the coins</li>
                    <li>Adding 2 more servo motors – I have left 2 dispensing slots in the structure and 2 pins of the Arduino empty. All 4 switches are there, I can just re-program anytime.</li>
                    <li>Detection of different coins – separating them by sizes</li>
                    <li>Write a code that rotates the servo motors in the opposite direction when repeatedly clicking on one of the buttons – this will make replenishing the items more convenient as the room for the hand and items is insufficient.</li>
                </ul>
            </div>
            <h2 style="text-align: center">---------- END OF MY DFAB JOURNEY... OR NOT? ----------</h2>

        </div>
    </body>
    <footer>Cheryl Ng &copy; 2020</footer>

</html>